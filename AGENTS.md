# MC-CPP architecture quickmap

- Build/entry: `CMakeLists.txt` wires GLFW (from `include/glfw`), GLAD, stb, glm, miniaudio, zlib, and compiles all sources; `compile.bat` is a clean rebuild helper. `MC-CPP.desktop` is a Linux launcher pointing to the built binary/assets.
- Game loop: `src/main.cpp` bootstraps GLFW/GLAD, loads window icon/font/shaders, instantiates `World`, `TextureManager`, and `Player`, registers input callbacks (mouse/key, block placement/breaking, saving, fullscreen toggle), loads block definitions via `load_blocks` from `data/blocks.mccpp`, initializes audio, and runs a per-frame update + render loop (player input, world tick, rendering, crosshair, debug text). Startup menu for music volume is shown before entering the game, mouse is captured when gameplay begins.
- World & chunks: `src/world.h/cpp` owns shaders, texture manager, player reference, block type registry, and a chunk map keyed by chunk coords. Handles block set/get with collision checks, daylight/block-light propagation queues, skylight init, chunk update scheduling, and rendering order (visible chunks sorted by distance, opaque then translucent passes).
- Chunk meshing: `src/chunk/chunk.h/cpp` stores block/light arrays for a 16x128x16 chunk, manages subchunks, mesh buffers, and GPU upload; `update_at_position` queues neighboring subchunks when a block changes. `src/chunk/subchunk.h/cpp` builds per-subchunk meshes, computing face visibility, per-face AO/smooth lighting, and selecting translucent vs opaque buffers based on `BlockType`.
- Block types & geometry: `src/renderer/block_type.*` turns `ModelData` + texture bindings into renderable block definitions (colliders, UVs, transparency flags). `src/models/*` provides model templates (cube, plant, liquid, slab, torch, door, ladder, etc.) with vertex data/UVs/lighting defaults; `data/blocks.mccpp` maps numeric IDs to model/texture assignments and names used at load.
- Rendering helpers: `src/renderer/shader.*` is a minimal GL shader wrapper; `src/renderer/texture_manager.*` builds a texture array atlas via stb_image and hands out indices; `src/text_renderer.*` implements bitmap text rendering with stb_truetype for UI/debug overlays.
- Simulation/entities: `src/entity/entity.*` defines physics integration (gravity, drag, collision resolution with block colliders) and movement state; `src/entity/player.*` extends it with input-driven acceleration, sprint logic, view matrices, and interpolation for rendering. `src/physics/collider.h` is the AABB + sweep test helper; `src/physics/hit.*` implements ray casting for block targeting.
- Persistence & world init: `src/save.*` loads/saves chunks to `save/` using NBT gzip, generates flat terrain fallback, seeds lighting, and queues meshing; `src/nbt_utils.*` handles minimal NBT ByteArray read/write with zlib.
- Audio: `src/audio.*` initializes miniaudio, scans `assets/audio/music/`, and schedules randomized music playback with simple timing logic.
- Config/utils: `src/options.h` holds tunables (render distance, FOV, lighting flags); `src/util.h` collects direction constants and a hash for `glm::ivec3` used in chunk maps. `compile.bat` rebuilds from a fresh `build/` folder via `cmake -S . -B build`.

Note: Third-party libraries live under `include/` (glfw, glad, glm, stb, zlib, miniaudio) and were not inspected per request.
